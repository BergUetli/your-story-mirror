<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Onboarding Flow - Memory Scape</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    }
    .step-card {
      transition: all 0.3s ease;
    }
    textarea {
      min-height: 120px;
      resize: vertical;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 min-h-screen p-6">
  
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">🧪 Onboarding Flow Tester</h1>
      <p class="text-gray-600">Test the 13-step onboarding without creating accounts</p>
    </div>

    <!-- Instructions -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4">📋 Testing Instructions</h2>
      <ol class="list-decimal list-inside space-y-2 text-gray-700">
        <li>Fill in all 13 steps to see how the flow works</li>
        <li>Required fields are marked with a red asterisk (*)</li>
        <li>Optional fields can be skipped by clicking "Next"</li>
        <li>Use the "Back" button to review previous answers</li>
        <li>At the end, you'll see a summary of all collected data</li>
        <li><strong>Note:</strong> This is a test page - data is NOT saved to the database</li>
      </ol>
    </div>

    <!-- Onboarding Simulator -->
    <div id="onboarding-container" class="bg-white rounded-lg shadow-lg p-8">
      <!-- Content will be dynamically generated -->
    </div>

    <!-- Results Panel (hidden initially) -->
    <div id="results-panel" class="hidden bg-white rounded-lg shadow-lg p-8 mt-6">
      <h2 class="text-2xl font-bold text-green-600 mb-4">✅ Onboarding Complete!</h2>
      <p class="text-gray-600 mb-4">Here's what would be saved to the database:</p>
      <pre id="results-json" class="bg-gray-100 p-4 rounded overflow-auto text-sm"></pre>
      <button onclick="resetOnboarding()" class="mt-4 px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
        Start Over
      </button>
    </div>
  </div>

  <script>
    // Onboarding steps configuration
    const steps = [
      { title: "What's your name?", subtitle: "The name you'd like to be remembered by", field: 'name', type: 'text', placeholder: 'Enter your name...', required: true, icon: '👤' },
      { title: "How old are you?", subtitle: "This helps us understand your life's timeline", field: 'age', type: 'number', placeholder: 'Enter your age...', required: true, icon: '📅' },
      { title: "When were you born?", subtitle: "Your birth date anchors your memory timeline", field: 'birthDate', type: 'date', placeholder: '', required: true, icon: '🎂' },
      { title: "Where were you born?", subtitle: "The place where your story began", field: 'birthPlace', type: 'text', placeholder: 'City, Country...', required: true, icon: '📍' },
      { title: "Where do you live now?", subtitle: "Your current home in the world", field: 'currentLocation', type: 'text', placeholder: 'City, Country...', required: true, icon: '🏠' },
      { title: "What do you do for a living?", subtitle: "Your work or what keeps you busy", field: 'occupation', type: 'text', placeholder: 'e.g., Software Engineer, Teacher, Student...', required: true, icon: '💼' },
      { title: "What's your relationship status?", subtitle: "Helps us understand your life context", field: 'relationshipStatus', type: 'select', options: ['Single', 'In a relationship', 'Engaged', 'Married', 'Divorced', 'Widowed', "It's complicated", 'Prefer not to say'], required: false, icon: '💕' },
      { title: "What's your cultural background?", subtitle: "The cultures and traditions that shaped you", field: 'culturalBackground', type: 'text', placeholder: 'e.g., Indian, Chinese-American...', required: false, icon: '🌍' },
      { title: "What languages do you speak?", subtitle: "All the languages you're comfortable with", field: 'languagesSpoken', type: 'text', placeholder: 'e.g., English, Spanish, Mandarin...', required: false, icon: '📚' },
      { title: "What do you love doing?", subtitle: "Your hobbies, passions, and interests", field: 'hobbiesInterests', type: 'textarea', placeholder: 'e.g., Reading, hiking, cooking...', required: false, icon: '✨' },
      { title: "Share a moment that defined you", subtitle: "A major life event that shaped who you are today", field: 'majorLifeEvent', type: 'textarea', placeholder: 'e.g., Graduating college, moving abroad...', required: false, icon: '🎯' },
      { title: "What matters most to you?", subtitle: "Your core values and principles", field: 'coreValues', type: 'textarea', placeholder: 'e.g., Family, honesty, creativity...', required: false, icon: '❤️' },
      { title: "What are you working towards?", subtitle: "Your dreams, aspirations, and life goals", field: 'lifeGoals', type: 'textarea', placeholder: 'e.g., Build a career, travel the world...', required: false, icon: '🎯' }
    ];

    let currentStep = 0;
    let formData = {};

    function renderStep() {
      const step = steps[currentStep];
      const container = document.getElementById('onboarding-container');
      
      let inputHtml = '';
      if (step.type === 'textarea') {
        inputHtml = `<textarea id="field-input" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="${step.placeholder}">${formData[step.field] || ''}</textarea>`;
      } else if (step.type === 'select') {
        inputHtml = `<select id="field-input" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
          <option value="">Select one...</option>
          ${step.options.map(opt => `<option value="${opt}" ${formData[step.field] === opt ? 'selected' : ''}>${opt}</option>`).join('')}
        </select>`;
      } else {
        inputHtml = `<input type="${step.type}" id="field-input" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="${step.placeholder}" value="${formData[step.field] || ''}" />`;
      }

      container.innerHTML = `
        <div class="text-center mb-8">
          <div class="text-6xl mb-4">${step.icon}</div>
          <div class="text-sm text-gray-500 mb-2">Step ${currentStep + 1} of ${steps.length}</div>
          <h2 class="text-3xl font-bold text-gray-800 mb-2">
            ${step.title}
            ${step.required ? '<span class="text-red-500 text-2xl">*</span>' : ''}
          </h2>
          <p class="text-gray-600">${step.subtitle}</p>
          ${!step.required ? '<p class="text-sm text-gray-400 mt-1">Optional - but helps us know you better</p>' : ''}
        </div>

        <div class="mb-6">
          ${inputHtml}
        </div>

        <div class="flex gap-3">
          ${currentStep > 0 ? '<button onclick="previousStep()" class="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">← Back</button>' : ''}
          <button onclick="nextStep()" class="flex-1 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700">
            ${currentStep < steps.length - 1 ? 'Next →' : 'Complete Setup ✨'}
          </button>
        </div>

        <div class="mt-6">
          <div class="w-full bg-gray-200 rounded-full h-2">
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 h-2 rounded-full transition-all duration-300" style="width: ${((currentStep + 1) / steps.length) * 100}%"></div>
          </div>
        </div>
      `;

      document.getElementById('field-input').focus();
    }

    function nextStep() {
      const step = steps[currentStep];
      const input = document.getElementById('field-input');
      const value = input.value.trim();

      // Validate required fields
      if (step.required && !value) {
        alert('Please fill in this required field');
        return;
      }

      // Save value
      formData[step.field] = value;

      // Move to next step or complete
      if (currentStep < steps.length - 1) {
        currentStep++;
        renderStep();
      } else {
        completeOnboarding();
      }
    }

    function previousStep() {
      if (currentStep > 0) {
        currentStep--;
        renderStep();
      }
    }

    function completeOnboarding() {
      // Calculate completeness score
      const filledFields = Object.values(formData).filter(v => v).length;
      const totalFields = steps.length;
      const completenessScore = Math.round((filledFields / totalFields) * 100);

      // Format data as it would be saved
      const dbData = {
        preferred_name: formData.name,
        age: parseInt(formData.age),
        birth_date: formData.birthDate,
        hometown: formData.birthPlace,
        location: formData.currentLocation,
        occupation: formData.occupation,
        relationship_status: formData.relationshipStatus || null,
        cultural_background: formData.culturalBackground ? formData.culturalBackground.split(',').map(s => s.trim()) : [],
        languages_spoken: formData.languagesSpoken ? formData.languagesSpoken.split(',').map(s => s.trim()) : [],
        hobbies_interests: formData.hobbiesInterests ? formData.hobbiesInterests.split(',').map(s => s.trim()) : [],
        major_life_events: formData.majorLifeEvent ? [{
          event: formData.majorLifeEvent,
          significance: "Shared during onboarding",
          year: new Date().getFullYear()
        }] : [],
        core_values: formData.coreValues ? formData.coreValues.split(',').map(s => s.trim()) : [],
        life_goals: formData.lifeGoals ? formData.lifeGoals.split(',').map(s => s.trim()) : [],
        profile_completeness_score: completenessScore,
        onboarding_completed: true
      };

      // Show results
      document.getElementById('onboarding-container').classList.add('hidden');
      document.getElementById('results-panel').classList.remove('hidden');
      document.getElementById('results-json').textContent = JSON.stringify(dbData, null, 2);
    }

    function resetOnboarding() {
      currentStep = 0;
      formData = {};
      document.getElementById('onboarding-container').classList.remove('hidden');
      document.getElementById('results-panel').classList.add('hidden');
      renderStep();
    }

    // Initialize
    renderStep();
  </script>

</body>
</html>
